apiVersion: v1
kind: ConfigMap
metadata:
  name: guitartortona-api-config
data:
  application.yaml: |
    # Management server su porta separata
    management:
      server:
        port: 8081
      endpoints:
        web:
          exposure:
            include: health,info,metrics,prometheus,loggers
          base-path: /actuator
      endpoint:
        health:
          show-details: always
          probes:
            enabled: true
      metrics:
        export:
          prometheus:
            enabled: true
        tags:
          environment: ${ENVIRONMENT:unknown}
    
    # Server principale
    server:
      port: 8080
      tomcat:
        basedir: /tmp
      compression:
        enabled: true
      http2:
        enabled: true
    
    spring:
      jpa:
        open-in-view: false  # Best practice
        show-sql: false
    
    # Logging su stdout (per Loki)
    logging:
      level:
        root: INFO
        it.mmzitarosa.guitartortona: DEBUG
      pattern:
        console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
